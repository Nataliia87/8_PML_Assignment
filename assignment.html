<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Loading data,Cleaning &amp; Exploratory analysis</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<p>##Introduction
  Using devices such as Jawbone Up, Nike FuelBand, and Fitbit it is now possible to collect a large amount of data about personal activity relatively inexpensively. These type of devices are part of the quantified self movement â€“ a group of enthusiasts who take measurements about themselves regularly to improve their health, to find patterns in their behavior, or because they are tech geeks. One thing that people regularly do is quantify how much of a particular activity they do, but they rarely quantify how well they do it. In this project, your goal will be to use data from accelerometers on the belt, forearm, arm, and dumbell of 6 participants. They were asked to perform barbell lifts correctly and incorrectly in 5 different ways. More information is available from the website here: <a href="http://web.archive.org/web/20161224072740/http:/groupware.les.inf.puc-rio.br/har">http://web.archive.org/web/20161224072740/http:/groupware.les.inf.puc-rio.br/har</a> (see the section on the Weight Lifting Exercise Dataset).</p>

<p>The goal of my project is to predict the manner in which people did the exercise in testing data set. I will use as much as possible variables to predict estimate, will fit 3 different models to data and choose what is beter. </p>

<h2>Loading data,Cleaning &amp; Exploratory analysis</h2>

<pre><code class="r">data &lt;- read.csv(&quot;pml-training.csv&quot;, header=T, na.strings=c(&quot;&quot;,&quot;NA&quot;))
data&lt;-data[,colSums(is.na(data))==0]
dim(data)
</code></pre>

<pre><code>## [1] 19622    60
</code></pre>

<pre><code class="r">set.seed(1234)
library(caret)
inTrain&lt;-createDataPartition(y=data$classe,p=0.7,list=FALSE)
training&lt;-data[inTrain,]
testing&lt;-data[-inTrain,]
dim(training)
</code></pre>

<pre><code>## [1] 13737    60
</code></pre>

<pre><code class="r">names(training)
</code></pre>

<pre><code>##  [1] &quot;X&quot;                    &quot;user_name&quot;            &quot;raw_timestamp_part_1&quot;
##  [4] &quot;raw_timestamp_part_2&quot; &quot;cvtd_timestamp&quot;       &quot;new_window&quot;          
##  [7] &quot;num_window&quot;           &quot;roll_belt&quot;            &quot;pitch_belt&quot;          
## [10] &quot;yaw_belt&quot;             &quot;total_accel_belt&quot;     &quot;gyros_belt_x&quot;        
## [13] &quot;gyros_belt_y&quot;         &quot;gyros_belt_z&quot;         &quot;accel_belt_x&quot;        
## [16] &quot;accel_belt_y&quot;         &quot;accel_belt_z&quot;         &quot;magnet_belt_x&quot;       
## [19] &quot;magnet_belt_y&quot;        &quot;magnet_belt_z&quot;        &quot;roll_arm&quot;            
## [22] &quot;pitch_arm&quot;            &quot;yaw_arm&quot;              &quot;total_accel_arm&quot;     
## [25] &quot;gyros_arm_x&quot;          &quot;gyros_arm_y&quot;          &quot;gyros_arm_z&quot;         
## [28] &quot;accel_arm_x&quot;          &quot;accel_arm_y&quot;          &quot;accel_arm_z&quot;         
## [31] &quot;magnet_arm_x&quot;         &quot;magnet_arm_y&quot;         &quot;magnet_arm_z&quot;        
## [34] &quot;roll_dumbbell&quot;        &quot;pitch_dumbbell&quot;       &quot;yaw_dumbbell&quot;        
## [37] &quot;total_accel_dumbbell&quot; &quot;gyros_dumbbell_x&quot;     &quot;gyros_dumbbell_y&quot;    
## [40] &quot;gyros_dumbbell_z&quot;     &quot;accel_dumbbell_x&quot;     &quot;accel_dumbbell_y&quot;    
## [43] &quot;accel_dumbbell_z&quot;     &quot;magnet_dumbbell_x&quot;    &quot;magnet_dumbbell_y&quot;   
## [46] &quot;magnet_dumbbell_z&quot;    &quot;roll_forearm&quot;         &quot;pitch_forearm&quot;       
## [49] &quot;yaw_forearm&quot;          &quot;total_accel_forearm&quot;  &quot;gyros_forearm_x&quot;     
## [52] &quot;gyros_forearm_y&quot;      &quot;gyros_forearm_z&quot;      &quot;accel_forearm_x&quot;     
## [55] &quot;accel_forearm_y&quot;      &quot;accel_forearm_z&quot;      &quot;magnet_forearm_x&quot;    
## [58] &quot;magnet_forearm_y&quot;     &quot;magnet_forearm_z&quot;     &quot;classe&quot;
</code></pre>

<pre><code class="r">library(plot3D)
suppressWarnings(plot3D::points3D(
+         training$magnet_arm_x, 
+         training$magnet_arm_y, 
+         training$magnet_arm_z, col=training$classe,main=&quot;Magnet Arm by Activity&quot;,pch=20, cex=0.8))
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-15"/></p>

<pre><code class="r">suppressWarnings(plot3D::points3D(
+         training$magnet_forearm_x, 
+         training$magnet_forearm_y, 
+         training$magnet_forearm_z, col=training$classe,main=&quot;Magnet Forearm by Activity&quot;,pch=20, cex=0.8))
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-15"/></p>

<p>We see from this plots, that there is a pattern that depends on activity type.</p>

<p>We will not use first 5 columns as predictors.</p>

<pre><code class="r">training&lt;-training[,6:ncol(training)]
</code></pre>

<p>##Fitting Prediction models
Firstly lets try the simplest model - Decision Trees.</p>

<pre><code class="r">set.seed(1234)
mod1&lt;-train(classe~.,method=&quot;rpart&quot;,data=training)
library(rattle)
</code></pre>

<pre><code>## Rattle: A free graphical interface for data mining with R.
## Version 4.1.0 Copyright (c) 2006-2015 Togaware Pty Ltd.
## Type &#39;rattle()&#39; to shake, rattle, and roll your data.
</code></pre>

<pre><code class="r">fancyRpartPlot(mod1$finalModel)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-17"/></p>

<pre><code class="r">confusionMatrix(predict(mod1,testing),testing$classe)
</code></pre>

<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction    A    B    C    D    E
##          A 1530  486  493  452  168
##          B   35  379   31  164  145
##          C  105  274  502  348  302
##          D    0    0    0    0    0
##          E    4    0    0    0  467
## 
## Overall Statistics
##                                           
##                Accuracy : 0.489           
##                  95% CI : (0.4762, 0.5019)
##     No Information Rate : 0.2845          
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
##                                           
##                   Kappa : 0.3311          
##  Mcnemar&#39;s Test P-Value : NA              
## 
## Statistics by Class:
## 
##                      Class: A Class: B Class: C Class: D Class: E
## Sensitivity            0.9140   0.3327   0.4893   0.0000  0.43161
## Specificity            0.6203   0.9210   0.7882   1.0000  0.99917
## Pos Pred Value         0.4890   0.5027   0.3279      NaN  0.99151
## Neg Pred Value         0.9478   0.8519   0.8797   0.8362  0.88641
## Prevalence             0.2845   0.1935   0.1743   0.1638  0.18386
## Detection Rate         0.2600   0.0644   0.0853   0.0000  0.07935
## Detection Prevalence   0.5317   0.1281   0.2602   0.0000  0.08003
## Balanced Accuracy      0.7671   0.6269   0.6388   0.5000  0.71539
</code></pre>

<p>As we see this model is not good. It&#39;s accuracy is 49.57%, it has a lot of errors. So we will not use it further.</p>

<p>The second one will be Boosting:</p>

<pre><code class="r">set.seed(1234)
modControl &lt;- trainControl(method=&quot;cv&quot;,number=5,verboseIter=FALSE)
mod2&lt;-train(classe~.,method=&quot;gbm&quot;,data=training,trControl=modControl,verbose=FALSE)
plot(mod2, ylim=c(0.7, 1))
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-18"/></p>

<pre><code class="r">pred2&lt;-predict(mod2,testing)
confusionMatrix(pred2,testing$classe)
</code></pre>

<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction    A    B    C    D    E
##          A 1673   12    0    0    1
##          B    1 1108    7   10    1
##          C    0   14 1018   14    3
##          D    0    5    1  940   10
##          E    0    0    0    0 1067
## 
## Overall Statistics
##                                           
##                Accuracy : 0.9866          
##                  95% CI : (0.9833, 0.9894)
##     No Information Rate : 0.2845          
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
##                                           
##                   Kappa : 0.983           
##  Mcnemar&#39;s Test P-Value : NA              
## 
## Statistics by Class:
## 
##                      Class: A Class: B Class: C Class: D Class: E
## Sensitivity            0.9994   0.9728   0.9922   0.9751   0.9861
## Specificity            0.9969   0.9960   0.9936   0.9967   1.0000
## Pos Pred Value         0.9923   0.9831   0.9704   0.9833   1.0000
## Neg Pred Value         0.9998   0.9935   0.9983   0.9951   0.9969
## Prevalence             0.2845   0.1935   0.1743   0.1638   0.1839
## Detection Rate         0.2843   0.1883   0.1730   0.1597   0.1813
## Detection Prevalence   0.2865   0.1915   0.1782   0.1624   0.1813
## Balanced Accuracy      0.9982   0.9844   0.9929   0.9859   0.9931
</code></pre>

<p>This method is definitely beter. We have less errors and accuracy is 98.83%. This is a great value.</p>

<p>And the third we will try random Forests^</p>

<pre><code class="r">library(randomForest)
mod3&lt;- randomForest(classe ~ ., data=training)
plot(mod3)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-19"/></p>

<pre><code class="r">pred3&lt;-predict(mod3,testing)
confusionMatrix(pred3,testing$classe)
</code></pre>

<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction    A    B    C    D    E
##          A 1674    3    0    0    0
##          B    0 1135    4    0    0
##          C    0    1 1021    4    0
##          D    0    0    1  960    0
##          E    0    0    0    0 1082
## 
## Overall Statistics
##                                           
##                Accuracy : 0.9978          
##                  95% CI : (0.9962, 0.9988)
##     No Information Rate : 0.2845          
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
##                                           
##                   Kappa : 0.9972          
##  Mcnemar&#39;s Test P-Value : NA              
## 
## Statistics by Class:
## 
##                      Class: A Class: B Class: C Class: D Class: E
## Sensitivity            1.0000   0.9965   0.9951   0.9959   1.0000
## Specificity            0.9993   0.9992   0.9990   0.9998   1.0000
## Pos Pred Value         0.9982   0.9965   0.9951   0.9990   1.0000
## Neg Pred Value         1.0000   0.9992   0.9990   0.9992   1.0000
## Prevalence             0.2845   0.1935   0.1743   0.1638   0.1839
## Detection Rate         0.2845   0.1929   0.1735   0.1631   0.1839
## Detection Prevalence   0.2850   0.1935   0.1743   0.1633   0.1839
## Balanced Accuracy      0.9996   0.9978   0.9970   0.9978   1.0000
</code></pre>

<p>This model has beter accuracy - 99.86%. And we will use it to work with our test data set.</p>

<h2>Predicting results on testing data set</h2>

<pre><code class="r">datatest &lt;- read.csv(&quot;pml-testing.csv&quot;, header=T, na.strings=c(&quot;&quot;,&quot;NA&quot;))
datatest&lt;-datatest[,colSums(is.na(data))==0]
final&lt;- predict(mod2, newdata=datatest)
final
</code></pre>

<pre><code>##  [1] B A B A A E D B A A B C B A E E A B B B
## Levels: A B C D E
</code></pre>

<p>So, now we now in which way people were doing observed exersises.</p>

</body>

</html>
